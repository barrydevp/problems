#!/bin/bash

# exit on error
set -e

# Import
source ./setup

help() {
	cat <<EOF
  Usage:
    run --rs|zig|py --cf|dm <problem_id>

  Options:
    -r, --rs    Rust source
    -z, --zig   Zig source
    -c, --cpp   C++ source
        --c     C source
    -p, --py    Python source

    --cf        Codeforces
    --dm        DMOJ based (VNOI, DMOJ)

    -h, --help  Display help message

EOF
}

run_rust() {
	$CARGO run --bin $@
}

run_zig() {
	$ZIG build run -Dproblem=$@
}

run_cpp() {
	$CPP $@.cpp
	./a.out
}

run_c() {
	$CC $@.c
	./a.out
}

run_python() {
	$PYTHON3 $@.py
}

run_code() {
	if [ "$HELP_FLAG" = true ]; then
		help
		exit 1
	fi

	if [ ${#META[@]} -ne 0 ]; then
		cd ${META[0]}
	fi

	case $LANGUAGE in
	$RUST_LANG)
		run_rust $ARGS
		;;
	$ZIG_LANG)
		run_zig $ARGS
		;;
	$CPP_LANG)
		run_cpp $ARGS
		;;
	$C_LANG)
		run_c $ARGS
		;;
	$PYTHON_LANG)
		run_python $ARGS
		;;
	*)
		help
		;;
	esac
}

run_code
